require(SixSigma)
require(qcc)


#Valores de medição

perda_peso <- c(0.1418, 0.1385, 0.1402, 0.1415, 0.1371, 0.1463, 0.1391, 0.1311, 0.1463, 0.1445, 0.1529, 0.1274, 0.1403, 0.1431, 0.1394, 0.1381, 0.1439, 0.1560, 0.1492, 0.1420, 0.1286, 0.1464, 0.1423, 0.1320, 0.1417, 0.1409, 0.1436, 0.1348, 0.1486, 0.1488, 0.1500, 0.1473, 0.1528, 0.1491, 0.1511, 0.1404, 0.1443, 0.1393, 0.1318, 0.1398, 0.1376, 0.1499, 0.1302, 0.1416, 0.1467, 0.1373, 0.1526, 0.1475, 0.1378, 0.1498, 0.1472, 0.1398, 0.1436, 0.1444, 0.1478, 0.1415, 0.1371, 0.1651, 0.1421, 0.1332, 0.1408, 0.1500, 0.1459, 0.1312, 0.1358, 0.1368, 0.1362, 0.1510, 0.1549, 0.1423, 0.1320, 0.1441, 0.1453, 0.1481, 0.1545, 0.1495, 0.1385, 0.1389, 0.1387, 0.1406, 0.1464, 0.1436, 0.1371, 0.1519, 0.1434, 0.1413, 0.1597, 0.1393, 0.1403, 0.1496, 0.1350, 0.1528, 0.1423, 0.1283, 0.1483, 0.1117, 0.1608, 0.1556, 0.1344, 0.1413, 0.1461, 0.1481, 0.1418, 0.1349, 0.1287, 0.1354, 0.1481, 0.1317, 0.1338, 0.1370, 0.1488, 0.1346, 0.1499, 0.1484, 0.1566, 0.1398, 0.1511, 0.1408)

#Calculo do Cp

cp <- ss.ca.cp(perda_peso,0.10, 0.17)
print(cp)

#Calculo do Cpk
cpk <- ss.ca.cpk(perda_peso,0.10, 0.17)
print(cpk)

#Estudo SixSigma do Cp e Cpk
ss.study.ca(perda_peso, perda_peso, LSL = 0.10, USL = 0.17,
            Target = 0.136, alpha = 0.5,
            f.su = "Fracao de perda de peso")

#
##### Nivel Sigma do processo
#


#An?lise curto prazo;

median <- 0.1427
desvpad1 <- 0.007909
UCL <- 0.165
target <- 0.136
LCL <- 0.105

Cp <- ss.ca.cp(perda_peso,0.105, 0.165)
Cpk <- ss.ca.cpk(perda_peso,0.105, 0.165)

Z_LCL <- (LCL-median)/desvpad1
Z_UCL <- (UCL-median)/desvpad1

PFE_LCL <- 0.0000009060
PFE_UCL <- 0.0024553332
PFE_total <- PFE_LCL + PFE_UCL

PPM_LCL <- PFE_LCL*1000000
PPM_UCL <- PFE_UCL*1000000
PPM_total <- PPM_LCL+PPM_UCL

#An?lise longo prazo;

z_